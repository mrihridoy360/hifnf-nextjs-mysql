(()=>{var e={};e.id=7363,e.ids=[7363],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},5069:(e,r,s)=>{"use strict";s.d(r,{e:()=>i});let t=s(46101).createPool({host:process.env.MYSQL_HOST||"localhost",user:process.env.MYSQL_USER||"root",password:process.env.MYSQL_PASSWORD||"",database:process.env.MYSQL_DATABASE||"facebook_clone",waitForConnections:!0,connectionLimit:10,queueLimit:0});async function i({query:e,values:r}){try{if(!r||0===r.length){let[r]=await t.query(e);return r}let[s]=await t.execute(e,r);return s}catch(e){throw console.error("Database query error:",e),e}}},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11723:e=>{"use strict";e.exports=require("querystring")},12412:e=>{"use strict";e.exports=require("assert")},12909:(e,r,s)=>{"use strict";s.d(r,{N:()=>u});var t=s(13581),i=s(85665),n=s.n(i),a=s(5069);let u={providers:[(0,t.A)({name:"Credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){if(!e?.email||!e?.password)return null;try{let r=await (0,a.e)({query:"SELECT * FROM users WHERE email = ?",values:[e.email]});if(0===r.length)return null;let s=r[0];if(!await n().compare(e.password,s.password))return null;return{id:s.id,name:`${s.first_name} ${s.last_name}`,email:s.email,image:s.profile_picture,username:s.username}}catch(e){return console.error("Authentication error:",e),null}}})],callbacks:{jwt:async({token:e,user:r,trigger:s,session:t})=>(r&&(e.id=r.id,e.username=r.username),"update"===s&&t?.image&&(e.picture=t.image),e),session:async({session:e,token:r})=>(r&&(e.user.id=r.id,e.user.username=r.username,r.picture&&(e.user.image=r.picture)),e)},pages:{signIn:"/auth/signin",signOut:"/auth/signout",error:"/auth/error",newUser:"/auth/register"},session:{strategy:"jwt",maxAge:2592e3},cookies:{sessionToken:{name:"next-auth.session-token",options:{httpOnly:!0,sameSite:"lax",path:"/",secure:!0,domain:".gaanlagbe.com"}}},secret:process.env.NEXTAUTH_SECRET,debug:!1}},13581:(e,r)=>{"use strict";r.A=function(e){return{id:"credentials",name:"Credentials",type:"credentials",credentials:{},authorize:()=>null,options:e}}},19771:e=>{"use strict";e.exports=require("process")},27910:e=>{"use strict";e.exports=require("stream")},28303:e=>{function r(e){var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}r.keys=()=>[],r.resolve=r,r.id=28303,e.exports=r},28354:e=>{"use strict";e.exports=require("util")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},34631:e=>{"use strict";e.exports=require("tls")},41204:e=>{"use strict";e.exports=require("string_decoder")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},66136:e=>{"use strict";e.exports=require("timers")},74075:e=>{"use strict";e.exports=require("zlib")},78335:()=>{},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},91645:e=>{"use strict";e.exports=require("net")},92791:(e,r,s)=>{"use strict";s.r(r),s.d(r,{patchFetch:()=>h,routeModule:()=>l,serverHooks:()=>x,workAsyncStorage:()=>m,workUnitAsyncStorage:()=>g});var t={};s.r(t),s.d(t,{GET:()=>d});var i=s(96559),n=s(48088),a=s(37719),u=s(32190),o=s(35426),c=s(12909),p=s(5069);async function d(e){try{let r=await (0,o.getServerSession)(c.N);if(!r?.user?.id)return u.NextResponse.json({message:"Unauthorized"},{status:401});let s=new URL(e.url),t=parseInt(s.searchParams.get("limit")||"5"),i=await (0,p.e)({query:`
        SELECT id, username, first_name, last_name, profile_picture
        FROM users
        WHERE id != ?
        AND id NOT IN (
          SELECT IF(requester_id = ?, addressee_id, requester_id)
          FROM friendships
          WHERE (requester_id = ? OR addressee_id = ?)
          AND status IN ('accepted', 'pending')
        )
        ORDER BY RAND()
        LIMIT ?
      `,values:[r.user.id,r.user.id,r.user.id,r.user.id,t]});return u.NextResponse.json({suggestions:i})}catch(e){return console.error("Error fetching friend suggestions:",e),u.NextResponse.json({message:"Internal server error"},{status:500})}}let l=new i.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/friends/suggestions/route",pathname:"/api/friends/suggestions",filename:"route",bundlePath:"app/api/friends/suggestions/route"},resolvedPagePath:"C:\\Users\\mrihr\\Desktop\\hifnf_nextjs_mysql\\src\\app\\api\\friends\\suggestions\\route.ts",nextConfigOutput:"standalone",userland:t}),{workAsyncStorage:m,workUnitAsyncStorage:g,serverHooks:x}=l;function h(){return(0,a.patchFetch)({workAsyncStorage:m,workUnitAsyncStorage:g})}},94735:e=>{"use strict";e.exports=require("events")},96487:()=>{}};var r=require("../../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[4243,8203,2190,5426,5665],()=>s(92791));module.exports=t})();